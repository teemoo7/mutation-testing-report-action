name: 'Mutation Testing - Pitest report'

author: 'MicaÃ«l Paquier'

description: 'Read mutation testing report generated by Pitest and creates a check with annotations'

inputs:
  xml-report-path:
    description: 'Pitest XML report path'
    required: false
    default: 'target/pit-reports/mutations.xml'
  threshold:
    description: 'Threshold (in %) to reach with test strength metric so that check is green. Default is 80%'
    required: false
    default: '80'
  fail-workflow:
    description: 'If enabled, when the test strength is not matching the threshold, the workflow step will be marked as failure'
    required: false
    default: 'false'
  max-annotations:
    description: 'The maximal number of annotations that will be listed. Default is 5 (GitHub API limit is 50).'
    required: false
    default: '5'
  token:
    description: 'The GitHub token used to create checks'
    required: false
    default: ${{ github.token }}

outputs:
  test-strength:
    description: 'Computed test strength by the mutation test tool'
  result:
    description: 'Result of comparison between computed test strength and threshold. Values can be `success` or `failure`'

runs:
  using: 'node16'
  main: 'dist/index.js'
